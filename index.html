<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Relay Control</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 40px; }
    button { padding: 10px 20px; font-size: 18px; margin: 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Relay 1 Control</h1>
  <button id="on">ON</button>
  <button id="off">OFF</button>
  <p id="status">Status: —</p>

  <script>
    const statusEl = document.getElementById("status");

    const ws = new WebSocket("wss://" + window.location.host);
    ws.onopen = () => statusEl.textContent = "Status: WebSocket Connected ✅";
    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if (data.type === "callback") {
        statusEl.textContent = `Relay ${data.relay} ${data.value ? "ON" : "OFF"}`;
      }
    };

    async function setRelay(value) {
      await fetch("/api/setRelay", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id: 1, value })
      });
    }

    document.getElementById("on").onclick = () => setRelay(1);
    document.getElementById("off").onclick = () => setRelay(0);
  </script>
</body>
</html>
